{"ignition":{"config":{"merge":[{"compression":"","source":"data:,"}]},"version":"3.4.0"},"passwd":{"users":[{"groups":["docker"],"name":"coredns"},{"groups":["docker"],"name":"traefik"},{"groups":["docker"],"name":"haproxy"}]},"storage":{"directories":[{"group":{"name":"traefik"},"path":"/home/flatcar/.traefik/logs","user":{"name":"traefik"}},{"group":{"name":"traefik"},"path":"/home/flatcar/.traefik/acme","user":{"name":"traefik"}}],"files":[{"overwrite":true,"path":"/etc/systemd/resolved.conf.d/10-DNS-override.conf","contents":{"compression":"","source":"data:,%5BResolve%5D%0ADNS%3D172.20.0.1%0A"}},{"path":"/etc/systemd/resolved.conf.d/stop_dns_stub_listener.conf","contents":{"compression":"","source":"data:,%5BResolve%5D%0ADNSStubListener%3Dno%0A"}},{"group":{"name":"traefik"},"path":"/home/flatcar/.traefik/config/traefik.yml","user":{"name":"traefik"},"contents":{"compression":"gzip","source":"data:;base64,H4sIAAAAAAAC/4ySwW7bPAyA7wHyDoL/c+y0aYFApx9pg116KNbtPDAy7WiRLYGkvXhPP0i2k3RFgUVAIPGTP5KSnK/1cqFUZR2+ghy1ygrnay6EACt7yp2vs7ihgfOb/Y1aPa6n5Q7MqQus1SYGHPbotHre775/WS6WCzAGmV8+04/4Yq88NSBaZT/Ztyly6KoKybb1mPVuvY7WBoWs4eQM5BuUI3bjUikoy30rNLx62wq/wAEdayXU4cjxArWaRNF5DY+iX3i4CgmZtdLb9URWjOYDfXjY3OBVINuD4EfJtO+2ifdJtvfp6IJNzLaMpiPUqgLHqYkS+HjwQOXc13IRyPe2RBp9pTcnpEmN5+AZy93wjBV0Tm5E8UKmXXHaQoNaFShmvvgCz4LUgvvBSL01mA+Ni/kMktjKGhDkr8je9XNu43xXVg7o0rpp5qlS2IB1Wgmy/I9naILD3Phmxiccvg0Btcr2T5vtQzbHWTxBHYuLtvSXx0cy87LlpyM4h219zZUeRzoVfVPVldK7uuffSmV3eRr6cZP9RbZ5GrfkPwNvSH1MchQJrItU3qpf3+cQbO5QGFtDQ5DcU12UltCIp2EWfPI9C9S2rf/F8ycAAP//+StQs78DAAA="}},{"group":{"name":"traefik"},"path":"/home/flatcar/.traefik/config/external_service.yml","user":{"name":"traefik"},"contents":{"compression":"gzip","source":"data:;base64,H4sIAAAAAAAC/7STwU7zMBCE77/0v8OqJzjEtYMqhE+IE0fEE3TrbKlVY0frTVHfHlFiWlVUQSHcIns883ni3Yi09v8/AE6dEOfDN0CDebNKyI02/QoAReH9U/JR8tcaQAVvtKoyuaplv0OhssVdIAuPKcvVUhhp7bfaKKZ92qLkTkWS5XURZ+Kdd2QBW3/voxBHDGVTwmmgI5ZnyinsiC24kLpmHZDpHLyeErz+U/BPzQvjGiNOgd1bDUL3ujFFv/roUxXS1k8BfHQbZD5KR9bspWoJ3ean3N8W7GW43BI0hrN3KQfO30ZI2DxgwOiITzw/Th2HuNyj42Bhdpj0+dzc1qrWaqHMwt5orWcXf+c0GXdam9ml5n8dUWtlyjXeAwAA//9v/FZBywQAAA=="}},{"group":{"name":"traefik"},"path":"/home/flatcar/.traefik/.env","user":{"name":"traefik"},"contents":{"compression":"","source":"data:,CF_API_EMAIL%3D%0ACF_DNS_API_TOKEN%3D%0A"},"mode":384},{"group":{"name":"haproxy"},"path":"/home/flatcar/.haproxy/config/haproxy.cfg","user":{"name":"haproxy"},"contents":{"compression":"gzip","source":"data:;base64,H4sIAAAAAAAC/2yQ0WrEIBBF3wP5h3kupGyEUujPFKMTY2sc64yl+/clq6ylmxAQz73MHHSBFh3GAdpXGDNsOmX6uXbqMpXU8ThYXHUJwr0SyNXqv4E7WTxOMalDSuIp3mAg17n4HakIGIoRjcALn2TBYxSAeX/MGPM35pqNw5opCkYLzNtlru3FRwtPb0qper/p3d3EpCnjV0EW8JETGpksBn29mzTzv+LtLd4XbT6PbStlhx80MW+HxSl+XN3U2zCYX9Wzuhz/XGV/AwAA//+xcuiGqQEAAA=="}}]},"systemd":{"units":[{"contents":"[Unit]\nDescription=run CoreDNS\nRequires=docker.service\nAfter=docker.service\n\n[Service]\nType=simple\nUser=coredns\nGroup=coredns\nExecStartPre=-/usr/bin/docker stop coredns\nExecStartPre=-/usr/bin/docker rm coredns\nExecStartPre=/usr/bin/docker pull coredns/coredns:latest\nExecStart=/usr/bin/docker run --rm --name coredns\\\n  -v /home/flatcar/.coredns/config:/etc/coredns\\\n  -p 53:53 -p 53:53/udp -p 9153:9153\\\n  coredns/coredns -conf /etc/coredns/Corefile\n\n[Install]\nWantedBy=multi-user.target\n","enabled":true,"name":"coredns.service"},{"contents":"[Unit]\nDescription=run Traefik\nRequires=docker.service\nAfter=docker.service\n\n[Service]\nType=simple\nUser=traefik\nGroup=traefik\nExecStartPre=-/usr/bin/docker stop traefik\nExecStartPre=-/usr/bin/docker rm traefik\nExecStartPre=/usr/bin/docker pull traefik:latest\nExecStart=/usr/bin/docker run --rm --name traefik\\\n  --env-file /home/flatcar/.traefik/.env\\\n  -v /home/flatcar/.traefik/config:/etc/traefik\\\n  -v /home/flatcar/.traefik/logs:/logs\\\n  -v /home/flatcar/.traefik/acme:/acme\\\n  -v /var/run/docker.sock:/var/run/docker.sock\\\n  -p 80:80 -p 443:443/tcp -p 8082:8082/tcp -p 8443:8443/tcp\\\n  -l traefik.enable=true\\\n  traefik:latest\n\n[Install]\nWantedBy=multi-user.target\n","enabled":false,"name":"traefik.service"},{"contents":"[Unit]\nDescription=run HAProxy\nRequires=docker.service\nAfter=docker.service\n\n[Service]\nType=simple\nUser=haproxy\nGroup=haproxy\nExecStartPre=-/usr/bin/docker stop haproxy\nExecStartPre=-/usr/bin/docker rm haproxy\nExecStartPre=/usr/bin/docker pull harbor.reyokatsu.net/network/haproxy:3.2-dev7-alpine\nExecStart=/usr/bin/docker run --rm --name haproxy\\\n  -v /home/flatcar/.haproxy/config:/usr/local/etc/haproxy:ro\\\n  -p 222:222\\\n  harbor.reyokatsu.net/network/haproxy:3.2-dev7-alpine\n\n[Install]\nWantedBy=multi-user.target\n","enabled":true,"name":"haproxy.service"}]}}
